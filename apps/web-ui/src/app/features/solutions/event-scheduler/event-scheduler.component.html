<div class="solution-page-container">
  <div class="event-scheduler-header">
    <h2>Event Scheduler</h2>
    <div class="header-actions">
      <button nz-button nzType="primary" (click)="onCreateEvent()">
        <nz-icon nzType="plus"></nz-icon>
        Create Event
      </button>
    </div>
  </div>

  <div class="event-scheduler-layout">
    <!-- Left Side: Calendar -->
    <!-- <div class="calendar-panel"> -->
    <nz-calendar [nzValue]="selectedDate" (nzSelectChange)="onDateSelect($event)" nzMode="month" [nzFullscreen]="false">
      <!-- Custom date cell template - only events indicator -->
      <div *nzDateCell="let date" class="calendar-date-cell">
        <div class="events-indicator" *ngIf="getEventsForDate(date).length > 0">
          <nz-badge [nzCount]="getEventsForDate(date).length" nzSize="small"></nz-badge>
        </div>
      </div>
    </nz-calendar>
    <!-- </div> -->

    <!-- Right Side: Event Details -->
    <div class="event-details-panel">
      <div class="selected-date-header">
        <h3>{{ selectedDate | date: 'fullDate' }}</h3>
      </div>

      <div class="events-content">
        <div class="events-list" *ngIf="getEventsForDate(selectedDate).length > 0">
          <nz-card *ngFor="let event of getEventsForDate(selectedDate)" class="event-card" [nzTitle]="event.title" nzSize="small">
            <div class="event-content">
              <div class="event-type">
                <nz-icon
                  [nzType]="event.type === 'appointment' ? 'calendar' : event.type === 'reminder' ? 'bell' : 'phone'"
                  [nzTheme]="'outline'"
                >
                </nz-icon>
                <span class="type-label">{{ event.type | titlecase }}</span>
              </div>

              <p *ngIf="event.description" class="event-description">{{ event.description }}</p>

              <div class="event-actions">
                <button nz-button nzType="link" nzSize="small" (click)="onEditEvent(event)">
                  <nz-icon nzType="edit"></nz-icon>
                  Edit
                </button>
                <button nz-button nzType="link" nzSize="small" nzDanger (click)="onDeleteEvent(event)">
                  <nz-icon nzType="delete"></nz-icon>
                  Delete
                </button>
              </div>
            </div>
          </nz-card>
        </div>

        <div class="no-events" *ngIf="getEventsForDate(selectedDate).length === 0">
          <nz-empty nzNotFoundImage="simple" nzNotFoundContent="No events scheduled for this date">
            <div nz-empty-footer>
              <button nz-button nzType="primary" (click)="onCreateEvent()">
                <nz-icon nzType="plus"></nz-icon>
                Create Event
              </button>
            </div>
          </nz-empty>
        </div>
      </div>
    </div>
  </div>

  <!-- Event Form Drawer -->
  <nz-drawer [nzVisible]="isDrawerVisible" nzPlacement="right" [nzTitle]="drawerTitle" [nzWidth]="600" (nzOnClose)="onDrawerClose()">
    <ng-container *nzDrawerContent>
      <form [formGroup]="eventForm" (ngSubmit)="onSaveEvent()">
        <div nz-form nzLayout="vertical">
          <!-- Event Title -->
          <nz-form-item>
            <nz-form-label nzRequired>Event Title</nz-form-label>
            <nz-form-control nzErrorTip="Please enter event title (minimum 3 characters)">
              <input nz-input formControlName="title" placeholder="Enter event title" id="title" />
            </nz-form-control>
          </nz-form-item>

          <!-- Event Type -->
          <nz-form-item>
            <nz-form-label nzRequired>Event Type</nz-form-label>
            <nz-form-control>
              <nz-select formControlName="type" nzPlaceHolder="Select event type">
                <nz-option nzValue="appointment" nzLabel="Appointment">
                  <nz-icon nzType="calendar" nzTheme="outline"></nz-icon>
                  Appointment
                </nz-option>
                <nz-option nzValue="reminder" nzLabel="Reminder">
                  <nz-icon nzType="bell" nzTheme="outline"></nz-icon>
                  Reminder
                </nz-option>
                <nz-option nzValue="followup" nzLabel="Follow-up">
                  <nz-icon nzType="phone" nzTheme="outline"></nz-icon>
                  Follow-up
                </nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>

          <!-- Event Date -->
          <nz-form-item>
            <nz-form-label nzRequired>Date</nz-form-label>
            <nz-form-control>
              <nz-date-picker formControlName="date" nzPlaceHolder="Select date" style="width: 100%"> </nz-date-picker>
            </nz-form-control>
          </nz-form-item>

          <!-- Event Description -->
          <nz-form-item>
            <nz-form-label>Description</nz-form-label>
            <nz-form-control>
              <textarea nz-input formControlName="description" placeholder="Enter event description (optional)" rows="4"> </textarea>
            </nz-form-control>
          </nz-form-item>

          <!-- Form Actions -->
          <div class="drawer-actions">
            <button nz-button type="button" (click)="onDrawerClose()" style="margin-right: 8px">Cancel</button>
            <button nz-button nzType="primary" type="submit" [disabled]="eventForm.invalid">
              {{ editingEvent ? 'Update Event' : 'Create Event' }}
            </button>
          </div>
        </div>
      </form>
    </ng-container>
  </nz-drawer>
</div>
